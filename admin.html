<!DOCTYPE html> <html lang="es"> <head> <meta charset="UTF-8"> <title>Admin Carta Tilo Café</title> <style> body { font-family: Arial, sans-serif; margin: 20px; } h1 { color: #5a3825; } form { background: #f7f3f0; padding: 15px; border-radius: 10px; } input, textarea, select { width: 100%; padding: 8px; margin: 5px 0; } button { padding: 8px 12px; margin-top: 10px; background: #8c6954; color: white; border: none; border-radius: 5px; cursor: pointer; } button:hover { background: #6b4e3d; } table { width: 100%; border-collapse: collapse; margin-top: 20px; } th, td { border: 1px solid #ccc; padding: 8px; text-align: left; } img { max-width: 60px; border-radius: 5px; } .preview { margin-top: 10px; padding: 10px; background: #eee; border-radius: 5px; } .actions button { margin-right: 5px; } </style> </head> <body> <h1>Admin Carta Tilo Café</h1> <form id="productForm"> <input type="hidden" id="editIndex" value=""> <label>Nombre:</label> <input type="text" id="nombre" required> <label>Descripción:</label> <textarea id="descripcion" required></textarea> <label>Precio (solo número):</label> <input type="number" id="precio" required> <label>Imagen (solo nombre de archivo, ej: cafe.jpg):</label> <input type="text" id="imagen" required> <label>Categoría:</label> <input type="text" id="categoria" required> <button type="submit">Guardar Producto</button> </form> <div class="preview" id="previewBox"> <h3>Vista previa:</h3> <img id="previewImg" src="" alt="" style="max-width:100px"><br> <strong id="previewNombre"></strong><br> <span id="previewDescripcion"></span><br> <span id="previewPrecio"></span> </div> <h2>Productos actuales</h2> <table id="productsTable"> <thead> <tr> <th>Imagen</th> <th>Nombre</th> <th>Descripción</th> <th>Precio</th> <th>Categoría</th> <th>Acciones</th> </tr> </thead> <tbody></tbody> </table> <script> const TOKEN = "TU_TOKEN_AQUI"; const USERNAME = "cholose10"; const REPO = "Carta"; const FILE_PATH = "productos.json"; const BRANCH = "main"; let productos = []; // Cargar productos desde GitHub async function loadProducts() { const res = await fetch(https://raw.githubusercontent.com/${USERNAME}/${REPO}/${BRANCH}/${FILE_PATH}); productos = await res.json(); renderTable(); } loadProducts(); // Render tabla function renderTable() { const tbody = document.querySelector("#productsTable tbody"); tbody.innerHTML = ""; productos.forEach((p, index) => { const tr = document.createElement("tr"); tr.innerHTML = <td><img src="${p.imagen}" alt="${p.nombre}"></td> <td>${p.nombre}</td> <td>${p.descripcion}</td> <td>$${p.precio}</td> <td>${p.categoria}</td> <td class="actions"> <button onclick="editProduct(${index})">Editar</button> <button onclick="deleteProduct(${index})">Eliminar</button> </td> ; tbody.appendChild(tr); }); } // Vista previa en vivo ["nombre","descripcion","precio","imagen"].forEach(id => { document.getElementById(id).addEventListener("input", updatePreview); }); function updatePreview() { document.getElementById("previewImg").src = "img/" + document.getElementById("imagen").value; document.getElementById("previewNombre").textContent = document.getElementById("nombre").value; document.getElementById("previewDescripcion").textContent = document.getElementById("descripcion").value; document.getElementById("previewPrecio").textContent = "$" + document.getElementById("precio").value; } // Guardar producto (nuevo o editado) document.getElementById("productForm").addEventListener("submit", async function(e) { e.preventDefault(); const index = document.getElementById("editIndex").value; const nuevo = { nombre: document.getElementById("nombre").value, descripcion: document.getElementById("descripcion").value, precio: document.getElementById("precio").value, imagen: "img/" + document.getElementById("imagen").value, categoria: document.getElementById("categoria").value }; if (index === "") { productos.push(nuevo); } else { productos[index] = nuevo; document.getElementById("editIndex").value = ""; } await saveToGitHub(); renderTable(); this.reset(); updatePreview(); }); // Editar producto function editProduct(index) { const p = productos[index]; document.getElementById("nombre").value = p.nombre; document.getElementById("descripcion").value = p.descripcion; document.getElementById("precio").value = p.precio; document.getElementById("imagen").value = p.imagen.replace("img/",""); document.getElementById("categoria").value = p.categoria; document.getElementById("editIndex").value = index; updatePreview(); } // Eliminar producto async function deleteProduct(index) { if (confirm("¿Eliminar este producto?")) { productos.splice(index,1); await saveToGitHub(); renderTable(); } } // Guardar en GitHub async function saveToGitHub() { const getRes = await fetch(https://api.github.com/repos/${USERNAME}/${REPO}/contents/${FILE_PATH}); const fileData = await getRes.json(); const sha = fileData.sha; const content = btoa(unescape(encodeURIComponent(JSON.stringify(productos, null, 2)))); await fetch(https://api.github.com/repos/${USERNAME}/${REPO}/contents/${FILE_PATH}, { method: "PUT", headers: { "Authorization": token ${TOKEN}, "Content-Type": "application/json" }, body: JSON.stringify({ message: "Actualizar productos", content: content, sha: sha, branch: BRANCH }) }); } </script> </body> </html>
